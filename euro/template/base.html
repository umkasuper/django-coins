<!DOCTYPE html>
<html lang="ru" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta http-equiv="Content-Language" content="ru"/>
    <script type="text/javascript"  language="Javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"> </script>
    <link rel="stylesheet" type="text/css" href= "/media/css/base.css" />
    <title> {% block title %}Евро коллекция{% endblock %}</title>
</head>

<body id="doc-body">

<script type="text/javascript" language="Javascript">

    description = {};

    function info (owner, all, have) {
        this.owner = owner;
        this.all = all;
        this.have = have;
    };

    function set_li_value(id_name, text)
    {
        var country_info = description[id_name];
        {% if request.user.is_authenticated %}
            $('li a#' + id_name).text(text + ' (' + country_info.have + '/' + country_info.all + ')');
        {% else %}
            $('li a#' + id_name).text(text + ' (' + country_info.all + ')');
        {% endif %}
    };

    function inc_value_have(id_name)
    {
        description[id_name].have++;
        if (description[id_name].owner)
            inc_value_have(description[id_name].owner);

        set_li_value(id_name);
    };

    function dec_value_have(id_name)
    {
        description[id_name].have--;
        if (description[id_name].owner)
            dec_value_have(description[id_name].owner);

        set_li_value(id_name);
    };


    function onClinkHref()
    {
        var commands = window.event.target.id.split("_");
        var command = commands[0];
        var id = commands[1];

        // все показываем
        $("[id*='_absent']").show();
        $("[id*='_present']").show();

        // отключаем те которые отсутствуют
        if (command == 'show')
            $("[id*=" + id + "_absent]").hide();

        // отключаем те которые имеются
        if (command == 'hide')
            $("[id*=" + id +"_present]").hide();
    };

    function onClickIMG(item)
    {
        var img = $(item).css("background-image").replace(/[\(\)']+/g,'').split('/').pop();
        var id = $(item).attr("id").split('_');

        if (id[2] == 'absent')
        {
            $(item).css("background-image", "url(/media/uncheck.png)");
            $(item).attr("id", id[0] + '_' + id[1] + '_' + 'present');
            dec_value_have(id[1]);
        }
        else {
            $(item).css("background-image", "url(/media/check.png)");
            $(item).attr("id", id[0] + '_' + id[1] + '_' + 'absent');
            inc_value_have(id[1]);
        };
//(img == "check.png") ? $(item).css("background-image", "url(/media/uncheck.png)") : $(item).css("background-image", "url(/media/check.png)");
/*
        $.ajax({
            type: "POST",
            url: "/set/",
            data: {id: item.id.split('_')[0], operation: (img == "check.png") ? "remove" : "add"}
        }).done(function( msg ) {
                if (msg == "ok")
                {
                     (img == "check.png") ? $(item).css("background-image", "url(/media/uncheck.png)") : $(item).css("background-image", "url(/media/check.png)");
                }
            });
*/
    }
</script>

<div id="main-block"> <!-- начало главного блока -->

    <header id="header">
        <div style="float: right;">
            <a href="/accounts/logout/">Выход</a>
        </div>
        <div>
        {% if request.user.is_authenticated %}
           Привет пользователь {{ request.user.username }}
        {% else %}
            <a href="/accounts/login/">Вход</a>
        {% endif %}
        </div>

    </header>

    <nav id="navigation">
        <a href="/euro/?country=all">Евро союз</a>
        <a href="/russia/?type=all">Россия</a>
        <a href="/usa/?type=all">США</a>
    </nav>

    <div id="block-info"> <!-- тут содержиться и меню и информация -->

        {# начало рендеринга меню #}
        {% block left_side %}
            <div id="left_side">
            </div>
        {% endblock %}
        {# конец рендеринга меню #}

        {# начало рендеринга информации #}
        <article id="info">

            {% block info %}
            {% endblock %}

        </article>
        {# конец рендеринга информации #}

    </div>


    <footer id="footer"> <!-- начало описания подвала -->
        Это подвал
    </footer>

</div> <!-- конец главного блока -->

</body>
</html>


